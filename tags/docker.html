<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="/swim-emoji.png" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="alternate"
      type="application/rss+xml"
      title="tiim.ch ¬ª Tim Bachmann"
      href="/blog/rss.xml"
    />
    <link href="https://comments.tiim.ch/wm/webmentions" rel="webmention" />
    <link
      href="https://comments.tiim.ch/indieauth/metadata"
      rel="indieauth-metadata"
    />
    <link
      href="https://comments.tiim.ch/indieauth/authorize"
      rel="authorization_endpoint"
    />
    <link
      href="https://comments.tiim.ch/indieauth/token"
      rel="token_endpoint"
    />
    <link rel="micropub" href="https://comments.tiim.ch/micropub" />
    <link rel="microsub" href="https://aperture.p3k.io/microsub/801" />
    <title>Tim Bachmann</title>
    
		<link href="../_app/immutable/assets/0.C6Eg9DJ-.css" rel="stylesheet">
		<link href="../_app/immutable/assets/PostCardList.CCnAgNra.css" rel="stylesheet">
		<link href="../_app/immutable/assets/13.ByRJLs2r.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.DzMsK6iU.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BAJ0H9dG.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/N6vMP6K8.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CeH7VA1m.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BEFE7IlI.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.Bj6fPYMv.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Bzak7iHL.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/tirM1Ya0.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.0VHl-ngm.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/AumyIhAL.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BNYvmXM-.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/dVNlkfcI.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/56KfW9JE.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/13.CUoVclnw.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C-mP__dA.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D0QL1rvB.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Cf1uxiy_.js"><!--1i2n8r8--><!----><title>üè∑Ô∏èdocker - Tim Bachmann</title>
  </head>
  <body>
    <div id="svelte"><!--[--><!--[--><!----><div id="app"><nav class="navbar svelte-se4uza" aria-label="main navigation"><div class="navbar-brand svelte-se4uza"><a class="navbar-item svelte-se4uza" href="/">Tim Bachmann</a></div> <div class="navbar-menu desktop svelte-se4uza"><a href="/" class="navbar-item svelte-se4uza">Home</a> <a href="/projects" class="navbar-item svelte-se4uza">Projects</a> <a href="/blog" class="navbar-item svelte-se4uza">Blog</a> <a href="/pages/uses" class="navbar-item svelte-se4uza">Uses</a> <a class="navbar-item svelte-se4uza" href="/contact">Contact</a> <a class="navbar-item svelte-se4uza" href="/follow">Follow</a></div> <div class="navbar-menu mobile svelte-se4uza"><div><input id="header-toggle" class="header-checkbox svelte-se4uza" type="checkbox"/> <label for="header-toggle" class="toggle svelte-se4uza"><span class="svelte-se4uza"></span> <span class="svelte-se4uza"></span> <span class="svelte-se4uza"></span></label></div> <!--[!--><!--]--></div></nav><!----> <div class="section"><!--[--><!----><div class="container has-text-centered h-feed"><div class="section"><h1 class="p-name">üè∑Ô∏è Tag: docker</h1> <p><a href="/tags">‚Üê All Tags</a></p></div> <!--[!--><!--]--> <div class="section"><div class="proj-wrap svelte-wog6rf"><!--[--><article class="card h-entry svelte-2gevwt"><h3 class="card-header svelte-2gevwt"><!--[--><a href="/blog/2023-12-03-my-selfhosting-setup" class="p-name u-url">My Selfhosting Setup</a><!--]--></h3> <!--[--><time class="date dt-published svelte-2gevwt" datetime="Mon Dec 04 2023 08:00:00 GMT+0000 (Coordinated Universal Time)">12/4/2023</time><!--]--> <div class="card-content svelte-2gevwt"><!--[--><img class="u-featured svelte-2gevwt" src="https://media.tiim.ch/4a0a43eb-cf95-4273-b6a6-e085c9123985.webp" alt="My Selfhosting Setup"/><!--]--> <p class="p-summary"><!--[--><div><!---->A short overview on how I self-host.<!----></div><!--]--></p> <!--[--><div class="tags"><!--[--><a href="/tags/ansible" class="tag p-category">ansible</a><a href="/tags/docker" class="tag p-category">docker</a><a href="/tags/server" class="tag p-category">server</a><a href="/tags/traefik" class="tag p-category">traefik</a><!--]--></div><!--]--></div> <div class="spacer svelte-2gevwt"></div> <div class="links-wrap svelte-2gevwt"><!--[!--><!--]--> <!--[--><div class="links svelte-2gevwt"><!--[--><span class="svelte-2gevwt"><a href="/blog/2023-12-03-my-selfhosting-setup">Read More...</a></span><!--]--></div><!--]--></div></article><article class="card h-entry svelte-2gevwt"><h3 class="card-header svelte-2gevwt"><!--[--><a href="/blog/2023-01-24-no-such-file-or-directory-cgo" class="p-name u-url">"no such file or directory" after enabling CGO in Docker</a><!--]--></h3> <!--[--><time class="date dt-published svelte-2gevwt" datetime="Tue Jan 24 2023 00:00:00 GMT+0000 (Coordinated Universal Time)">1/24/2023</time><!--]--> <div class="card-content svelte-2gevwt"><!--[!--><!--]--> <p class="p-summary"><!--[--><div><!---->Quick fix for the "no such file or directory" error after enabling CGO, when running in a scratch docker image.<!----></div><!--]--></p> <!--[--><div class="tags"><!--[--><a href="/tags/cgo" class="tag p-category">cgo</a><a href="/tags/docker" class="tag p-category">docker</a><a href="/tags/go" class="tag p-category">go</a><!--]--></div><!--]--></div> <div class="spacer svelte-2gevwt"></div> <div class="links-wrap svelte-2gevwt"><!--[!--><!--]--> <!--[--><div class="links svelte-2gevwt"><!--[--><span class="svelte-2gevwt"><a href="/blog/2023-01-24-no-such-file-or-directory-cgo">Read More...</a></span><!--]--></div><!--]--></div></article><article class="card h-entry svelte-2gevwt"><h3 class="card-header svelte-2gevwt"><!--[--><a href="/blog/2023-01-15-weechat-docker" class="p-name u-url">Running the WeeChat IRC Client on a VPS in Docker</a><!--]--></h3> <!--[--><time class="date dt-published svelte-2gevwt" datetime="Sun Jan 15 2023 00:00:00 GMT+0000 (Coordinated Universal Time)">1/15/2023</time><!--]--> <div class="card-content svelte-2gevwt"><!--[--><img class="u-featured svelte-2gevwt" src="https://media.tiim.ch/a28c65a1-ed95-43d3-af87-a2ad222bee7f.jpg" alt="Running the WeeChat IRC Client on a VPS in Docker"/><!--]--> <p class="p-summary"><!--[--><div><!---->Walkthrough on how to setup the WeeChat IRC client in docker.<!----></div><!--]--></p> <!--[--><div class="tags"><!--[--><a href="/tags/docker" class="tag p-category">docker</a><a href="/tags/irc" class="tag p-category">irc</a><a href="/tags/weechat" class="tag p-category">weechat</a><!--]--></div><!--]--></div> <div class="spacer svelte-2gevwt"></div> <div class="links-wrap svelte-2gevwt"><!--[!--><!--]--> <!--[--><div class="links svelte-2gevwt"><!--[--><span class="svelte-2gevwt"><a href="/blog/2023-01-15-weechat-docker">Read More...</a></span><!--]--></div><!--]--></div></article><article class="card h-entry svelte-2gevwt"><h3 class="card-header svelte-2gevwt"><!--[--><a href="/projects/aqualetics-coach" class="p-name u-url">Aqualetics Coach</a><!--]--></h3> <!--[--><time class="date dt-published svelte-2gevwt" datetime="Sat Mar 05 2022 20:21:10 GMT+0000 (Coordinated Universal Time)">3/5/2022</time><!--]--> <div class="card-content svelte-2gevwt"><!--[!--><!--]--> <p class="p-summary"><!--[--><div><!----><p>An internal web app for swim schools. Developed specifically for the "Kids" program of <a href="https://www.swiss-aquatics.ch/sport-fuer-alle/kids-learn-to-swim/ausbildungssystem/">Swiss Aquatics</a>. Live in production at the Aqualetics swim school since August 2019.</p><!----></div><!--]--></p> <!--[--><div class="tags"><!--[--><a href="/tags/dev" class="tag p-category">dev</a><a href="/tags/docker" class="tag p-category">docker</a><a href="/tags/graphql" class="tag p-category">graphql</a><a href="/tags/hasura" class="tag p-category">hasura</a><a href="/tags/node" class="tag p-category">node</a><a href="/tags/postgresql" class="tag p-category">postgresql</a><a href="/tags/vue" class="tag p-category">vue</a><!--]--></div><!--]--></div> <div class="spacer svelte-2gevwt"></div> <div class="links-wrap svelte-2gevwt"><!--[--><div class="links svelte-2gevwt"><!--[--><span class="svelte-2gevwt"><!----><p><a href="https://sundrbi.ch/coach-application/" rel="nofollow noopener noreferrer">Overview</a></p><!----></span><span class="svelte-2gevwt"><!----><p><a href="https://aqualetics.ch/2019/09/15/schwimmcoach-applikation-innovation/" rel="nofollow noopener noreferrer">Blog Post üá©üá™</a></p><!----></span><span class="svelte-2gevwt"><!----><p><a href="https://aqualetics.ch" rel="nofollow noopener noreferrer">Aqualetics Swim School</a></p><!----></span><!--]--></div><!--]--> <!--[--><div class="links svelte-2gevwt"><!--[--><span class="svelte-2gevwt"><a href="/projects/aqualetics-coach">Read More...</a></span><!--]--></div><!--]--></div></article><article class="card h-entry svelte-2gevwt"><h3 class="card-header svelte-2gevwt"><!--[--><a href="/projects/indiego" class="p-name u-url">IndieGo</a><!--]--></h3> <!--[--><time class="date dt-published svelte-2gevwt" datetime="Wed Aug 02 2023 08:39:00 GMT+0000 (Coordinated Universal Time)">8/2/2023</time><!--]--> <div class="card-content svelte-2gevwt"><!--[--><img class="u-featured svelte-2gevwt" src="/assets/2022-07-first-go-project-commenting-api.png" alt="IndieGo"/><!--]--> <p class="p-summary"><!--[--><div><!----><p>I blogged about creating a comment system for my website <a href="https://tiim.ch/blog/2022-07-12-first-go-project-commenting-api">a while ago</a>,
and later how I <a href="https://tiim.ch/blog/2022-12-indiewebifying-my-website-part-1">implemented webmentions into that same project</a>.
Since then this little go program has grown quite a bit, and it has turned into a modular platform
that supports quite a few technologies:</p><!----></div><!--]--></p> <!--[--><div class="tags"><!--[--><a href="/tags/dev" class="tag p-category">dev</a><a href="/tags/docker" class="tag p-category">docker</a><a href="/tags/go" class="tag p-category">go</a><a href="/tags/golang" class="tag p-category">golang</a><a href="/tags/indieweb" class="tag p-category">indieweb</a><a href="/tags/sqlite" class="tag p-category">sqlite</a><!--]--></div><!--]--></div> <div class="spacer svelte-2gevwt"></div> <div class="links-wrap svelte-2gevwt"><!--[--><div class="links svelte-2gevwt"><!--[--><span class="svelte-2gevwt"><!----><p><a href="https://github.com/Tiim/IndieGo" rel="nofollow noopener noreferrer">IndieGo Github</a></p><!----></span><span class="svelte-2gevwt"><!----><p><a href="https://comments.tiim.ch" rel="nofollow noopener noreferrer">Admin Interface</a> - authentication required</p><!----></span><!--]--></div><!--]--> <!--[--><div class="links svelte-2gevwt"><!--[--><span class="svelte-2gevwt"><a href="/projects/indiego">Read More...</a></span><!--]--></div><!--]--></div></article><!--]--></div><!----></div></div><!----><!--]--></div> <div><footer class="svelte-cfdhmy"><div><!----><p>Built with SvelteKit and hosted on GitHub Pages.</p>
<p>View this website on <a href="https://github.com/Tiim/Tiim.github.io" rel="nofollow noopener noreferrer">GitHub</a>!</p>
<h2>Other pages</h2>
<ul>
<li><a href="https://tiim.ch/pages/links" rel="nofollow noopener noreferrer">Links and Blogroll</a></li>
</ul><!----></div> <p class="copyright svelte-cfdhmy">¬©Tim Bachmann 2026</p></footer><!----></div></div><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1a0qsqe = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.DzMsK6iU.js"),
						import("../_app/immutable/entry/app.Bj6fPYMv.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 13],
							data: [{type:"data",data:{footer:{html:"\u003Cp>Built with SvelteKit and hosted on GitHub Pages.\u003C/p>\n\u003Cp>View this website on \u003Ca href=\"https://github.com/Tiim/Tiim.github.io\" rel=\"nofollow noopener noreferrer\">GitHub\u003C/a>!\u003C/p>\n\u003Ch2>Other pages\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://tiim.ch/pages/links\" rel=\"nofollow noopener noreferrer\">Links and Blogroll\u003C/a>\u003C/li>\n\u003C/ul>",slug:"footer",uuid:"e556fd14-3acd-4a7b-9b31-929fdd6d2b7a",created:new Date(1690834579000),date:new Date(1690834579000),published:true,abstract:"\u003Cp>Built with SvelteKit and hosted on GitHub Pages.\u003C/p>",tags:[],links:void 0,type:"article",cover_image:void 0,description:"",folder:"metadata"}},uses:{}},{type:"data",data:{posts:[{html:"\u003Cblockquote class=\"callout callout-note\">\n\u003Cspan class=\"callout-title\">\u003Cspan class=\"callout-icon\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\">\u003Cpath d=\"M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h226.7c17 0 33.3-6.7 45.3-18.7l93.3-93.3c12-12 18.7-28.3 18.7-45.3V96c0-35.3-28.7-64-64-64zm0 64h320v224h-64c-17.7 0-32 14.3-32 32v64H64z\">\u003C/path>\u003C/svg>\u003C/span>Note\u003C/span>\u003Cp>This post is meant as a reference for myself. I only published it in case someone else might find it interesting.\nI did not spend much time on this post.\u003C/p>\n\u003C/blockquote>\n\u003Cp>I do host some services on a few rented VPS servers and on my \"home lab\", which is just an old desktop that is running in the basement.\nWhen I got into self-hosting, I decided I would host everything exclusively in docker, which has served me pretty well over the last few years. In the last while I\nhave learned a lot about Kubernetes, and am strongly considering switching my \"simple\" hosting setup for a more complex Kubernetes cluster. So before I do that I want\nto write down what my current setup looks like.\u003C/p>\n\u003Ch2>Setup\u003C/h2>\n\u003Cp>\u003Cimg src=\"https://media.tiim.ch/0887e318-9359-4753-abaf-49ae7c26dfcd.webp\" alt=\"\">\u003C/p>\n\u003Cp>As mentioned, everything is hosted in docker containers. Generally, I try to keep everything in docker-compose, since this allows me to specify the settings of the container once, and easily modify it later.\nTo have multiple services available on port 80 and 443, I use the Traeffik (Software) reverse proxy. I use Traefik without a config file, meaning it pulls the routes and rules directly from the labels of the\nrunning containers on the VPS. This makes it easy to launch a new service and have its reverse proxy config directly in the docker-compose file.\u003C/p>\n\u003Cp>Since many services use a database, and Postgres seems to be supported by many open-source projects, I decided to have a central Postgres instance running in a docker container. This allows me to\nback it up with a simple cron job in a single place. If a service does not support Postgres, I specify its database directly in the docker-compose file.\u003C/p>\n\u003Cp>Almost all services use disk access for either config, local files, or similar. I do have a docker folder that is the root of all locally stored files.\u003C/p>\n\u003Ch2>OS Setup\u003C/h2>\n\u003Cp>When I first started, I configured everything by hand, and documented how, why, and what I did. However I was not happy with this, I could not test it out and it was prone to errors.\nTherefore, I decided to use Ansible to set up the server and install all dependencies.\nThis worked well, so well that I decided that Ansible was good enough to use to operate the entire pipeline, even to automate the deployment of the services.\u003C/p>\n\u003Ch2>Deployment\u003C/h2>\n\u003Cp>I do have an ansible role per service, with its configuration (mostly) as ansible YAML files, and the docker-compose files and other config files as ansible templates. This worked great, with a single ansible-playbook command I can\nmake sure everything is running and has the right config.\nFor most services, I even built logic to make sure that when the docker-compose file or a config file changes, the container is restarted.\u003C/p>\n\u003Ch2>The good parts\u003C/h2>\n\u003Cp>I am quite happy with this system in general. Everything runs stable, backups are easy and automated, and deployments for services that are already configured are a breeze.\nI can keep the whole \"description\" of what is running in a single git repo, and make changes by editing config files.\nThis is a huge step up from manually deploying and keeping track of what docker commands to use for what service.\u003C/p>\n\u003Ch2>The not so good parts\u003C/h2>\n\u003Cp>Recently I noticed some pain points.\u003C/p>\n\u003Col>\n\u003Cli>If I want to deploy a service twice for two domain names, I have to create a copy of the role. This unfortunately leads to duplicated \"code\" which can (and does) lead to configuration drift.\u003C/li>\n\u003Cli>I have to code things myself that already exist. For example, restarting a container when a config value changes. For most services this is implemented, but not everywhere, and also not for all possible things that can be changed. This is not what I want to be concentrating on if I am writing the config to deploy a service.\u003C/li>\n\u003C/ol>\n\u003Cp>In general, I seem to have built a worse subset of Kubernetes myself, just without the robustness that makes Kubernetes so interesting.\u003C/p>\n\u003Ch2>My plan for the future\u003C/h2>\n\u003Cp>I am planning to replace docker with Kubernetes, specifically K3s (Software), a very lightweight and mostly \"batteries included\" Kubernetes distribution.\nAnsible will stay, but only as a tool to set up and configure the OS, install dependencies, and install and run K3S. Deployment of services I either want to do directly using the kubectl command line tool, or more likely using\nArgoCD, a project that pulls Kubernetes manifests from a Git repository and automatically deploys it.\u003C/p>\n\u003Cp>For the configuration, I will take a look at Helm (Software).\u003C/p>",slug:"blog/2023-12-03-my-selfhosting-setup",uuid:"3af67a63-5f3a-422c-8aee-5e3daa8921f9",date:new Date(1701676800000),created:new Date(1701637696000),aliases:null,title:"My Selfhosting Setup",published:true,modified:null,description:"A short overview on how I self-host.",cover_image:"https://media.tiim.ch/4a0a43eb-cf95-4273-b6a6-e085c9123985.webp",cover_image_txt:"Model: realvisxlV20_v20Bakedvae; beach sunset, palms, calm ocean, fine sand, cinematic shot, photorealistic ## (worst quality)",content_tags:["ansible","docker","traefik","server"],abstract:"\u003Cp>[!NOTE]\nThis post is meant as a reference for myself. I only published it in case someone else might find it interesting.\nI did not spend much time on this post.\u003C/p>",tags:["ansible","docker","server","traefik"],links:void 0,type:"article",folder:"blog"},{html:"\u003Cp>Today I ran into the an error trying to deploy my go app in docker, where the container refused to start with the extremely helpful message \u003Ccode>exec /app/indiego: no such file or directory\u003C/code>. I had removed the \u003Ccode>CGO_ENABLE=0\u003C/code> variable from the Dockerfile, because I needed to enable cgo for a library. What I found out was that when enabling cgo, the resulting binary is not statically linked anymore and now depends on libc or musl. Since the \u003Ccode>scratch\u003C/code> image does not contain literally anything, the binary can't find the libraries and crashes with the aforementioned error.\u003C/p>\n\u003Cp>To include libc into the container, I simply changed the base image from \u003Ccode>scratch\u003C/code> to \u003Ccode>alpine\u003C/code>, which includes libc. This makes the image slightly larger but this seemed way easier than trying to include libc directly.\u003C/p>\n\u003Cp>As a bonus I got to delete the \u003Ccode>/usr/share/zoneinfo\u003C/code> and \u003Ccode>ca-certificates.crt\u003C/code> files, and rely on those provided by alpine.\u003C/p>\n\u003Cp>You can see the commit to IndieGo \u003Ca href=\"https://github.com/Tiim/IndieGo/commit/63968814de7e39f295386bf398b583aa8bf0411c\" rel=\"nofollow noopener noreferrer\">here\u003C/a>.\u003C/p>",slug:"blog/2023-01-24-no-such-file-or-directory-cgo",uuid:"dd580343-9e0f-4754-93dd-25667e6b5859",date:new Date(1674518400000),created:new Date(1674593651330),aliases:[null],title:"\"no such file or directory\" after enabling CGO in Docker",published:true,modified:null,description:"Quick fix for the \"no such file or directory\" error after enabling CGO, when running in a scratch docker image.",cover_image:void 0,cover_image_txt:"",content_tags:["go","cgo","docker"],abstract:"\u003Cp>Today I ran into the an error trying to deploy my go app in docker, where the container refused to start with the extremely helpful message \u003Ccode>exec /app/indiego: no such file or directory\u003C/code>. I had removed the \u003Ccode>CGO_ENABLE=0\u003C/code> variable from the Dockerfile, because I needed to enable cgo for a library. What I found out was that when enabling cgo, the resulting binary is not statically linked anymore and now depends on libc or musl. Since the \u003Ccode>scratch\u003C/code> image does not contain literally anything, the binary can't find the libraries and crashes with the aforementioned error.\u003C/p>",tags:["cgo","docker","go"],links:void 0,type:"article",folder:"blog"},{html:"\u003Cp>I have recently gotten interested in IRC for some reason and have been looking for a client that I like. I have used \u003Ca href=\"https://hexchat.github.io/\" rel=\"nofollow noopener noreferrer\">HexChat\u003C/a> in the past, but I don't really fancy having yet another communications program running on my PC next to discord, zoom, telegram and thunderbird. I have been trying to use the IRC feature of thunderbird, but even though it works, it feels very much like an afterthought.\u003C/p>\n\u003Cp>The one client I have seen mentioned a lot is \u003Ca href=\"https://weechat.org/\" rel=\"nofollow noopener noreferrer\">WeeChat\u003C/a> (not to be confused with WeChat, the Chinese instant messenger). WeeChat runs in the terminal as a \u003Ca href=\"https://en.wikipedia.org/wiki/Text-based_user_interface\" rel=\"nofollow noopener noreferrer\">TUI\u003C/a> and after a while of getting used to (and after enabling 'mouse mode') it seems intuitive enough.\u003C/p>\n\u003Cp>The nice thing about WeeChat running not as a graphical application, is that it makes it possible to run on a server and access it from anywhere over ssh.\u003C/p>\n\u003Cblockquote class=\"callout callout-info\">\n\u003Cspan class=\"callout-title\">\u003Cspan class=\"callout-icon\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\u003Cpath d=\"M256 512c141.4 0 256-114.6 256-256S397.4 0 256 0 0 114.6 0 256s114.6 256 256 256m-40-176h24v-64h-24c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-80c-13.3 0-24-10.7-24-24s10.7-24 24-24m40-144c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32\">\u003C/path>\u003C/svg>\u003C/span>INFO\u003C/span>\u003Cp>Except on mobile devices, but weechat has mobile apps that can connect to it directly.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Since I pretty much host all my selfhosted software in docker on a VPS, I was looking if someone already published a docker image for WeeChat. There is a bunch of them, but only \u003Ca href=\"https://hub.docker.com/r/weechat/weechat\" rel=\"nofollow noopener noreferrer\">weechat/weechat\u003C/a> (the official image) is still updated regularly. The docker hub page does not have any documentation, but I managed to find it in the \u003Ca href=\"https://github.com/weechat/weechat-container\" rel=\"nofollow noopener noreferrer\">weechat/weechat-container\u003C/a> github repo.\u003C/p>\n\u003Cp>As it says in the readme on github, you can start the container with\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-sh\">docker run -it weechat/weechat\n\u003C/code>\u003C/pre>\n\u003Cp>which will run weechat directly in the foreground.\u003C/p>\n\u003Cblockquote class=\"callout callout-info\">\n\u003Cspan class=\"callout-title\">\u003Cspan class=\"callout-icon\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\u003Cpath d=\"M256 512c141.4 0 256-114.6 256-256S397.4 0 256 0 0 114.6 0 256s114.6 256 256 256m-40-176h24v-64h-24c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-80c-13.3 0-24-10.7-24-24s10.7-24 24-24m40-144c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32\">\u003C/path>\u003C/svg>\u003C/span>Info\u003C/span>\u003Cp>Don't skip the \u003Ccode>-it\u003C/code> command line flags. The \u003Ccode>-i\u003C/code> or \u003Ccode>--interactive\u003C/code> keeps stdin open, which is required to send input to weechat. Weechat also closes immediately if the stdin gets closed, which took me a while to figure out.\nThe \u003Ccode>-t\u003C/code> or \u003Ccode>--tty\u003C/code> flag is required to provide a fake tty to the container. I don't really understand what that means but without this you won't see the user interface of weechat.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Running in the foreground is not really that helpful if we want to run weechat on a server, so we need to detach (let it run in the background) from the container with the \u003Ccode>-d\u003C/code> or \u003Ccode>--detach\u003C/code> flag. It also helps to specify a name for the container with the \u003Ccode>--name &#x3C;name>\u003C/code> argument, so we can quickly find the container again later. The docker command now looks like this:\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-sh\">docker run -it -d --name weechat weechat/weechat\n\u003C/code>\u003C/pre>\n\u003Cp>When we run this command, we will notice that weechat is running in the background. To access it we can run \u003Ccode>docker attach weechat\u003C/code>. To detach from weechat without exiting the container, we can press \u003Ccode>CTRL-p CTRL-q\u003C/code> as described in the \u003Ca href=\"https://docs.docker.com/engine/reference/commandline/attach/#description\" rel=\"nofollow noopener noreferrer\">docker attach reference\u003C/a>\u003C/p>\n\u003Cp>I noticed that there are two versions of the weechat image: a debian version and an alpine linux version. Generally the Alpine Linux versions of containers are smaller than the Debian versions, so I decided to use the alpine version: \u003Ccode>weechat/weechat:latest-alpine\u003C/code>.\u003C/p>\n\u003Cp>With this we are practically done, but if we ever remove and restart the container, all of the chat logs and customisations to weechat will be gone. To prevent this we need to add the config and log files to a volume.\u003C/p>\n\u003Cp>I generally use the folder \u003Ccode>~/docker/(service)\u003C/code> to point my docker volumes to, so I have a convenient place to inspect, modify and back up the data.\u003C/p>\n\u003Cp>Let's create the folder and add the volume to the docker container. I also added the \u003Ccode>--restart unless-stopped\u003C/code> flag to make sure the container gets restarted if it either exits for some reason of if docker restarts.\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-sh\">mkdir -p ~/docker/weechat/data\nmkdir -p ~/docker/weechat/config\n\ndocker run -it -d --restart unless-stopped \\\n    -v \"~/docker/weechat/data:/home/user/.weechat\" \\\n    -v \"~/docker/weechat/config:/home/user/.config/weechat\" \\\n    --name weechat weechat/weechat:latest-alpine`\n\u003C/code>\u003C/pre>\n\u003Cp>Running this command on the server is all we need to have weechat running in docker.\u003C/p>\n\u003Cblockquote>\n\u003Cp>But how do I quickly connect to weechat? Do I always have to first ssh into the server and then run docker attach?\u003C/p>\n\u003C/blockquote>\n\u003Cp>Yes but, as almost always, we can simplify this with a bash script:\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-bash\">#!/usr/bin/env bash\n\nHOST=&#x3C;ssh host>\nssh -t \"${HOST}\" docker attach weechat\n\u003C/code>\u003C/pre>\n\u003Cp>This bash script starts ssh with the \u003Ccode>-t\u003C/code> flag which tells ssh that the command is interactive.\nCopy this script into your \u003Ccode>~/.local/bin\u003C/code> folder and make it executable.\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-sh\">nano ~/.local/bin/weechat.sh\nchmod +x weechat.sh\n\u003C/code>\u003C/pre>\n\u003Cp>And that's it! Running \u003Ccode>weechat.sh\u003C/code> will open an ssh session to your server and attach to the weechat container. Happy Chatting!\u003C/p>\n\u003Cp>If you liked this post, consider subscribing to my blog via \u003Ca href=\"https://tiim.ch/blog/rss.xml\" rel=\"nofollow noopener noreferrer\">RSS\u003C/a>, or on \u003Ca href=\"https://tiim.ch/follow\" rel=\"nofollow noopener noreferrer\">social media\u003C/a>. If you have any questions, feel free to \u003Ca href=\"https://tiim.ch/contact\" rel=\"nofollow noopener noreferrer\">contact me\u003C/a>. I also usually hang out in \u003Ca href=\"irc://irc.libera.chat/##tiim\">\u003Ccode>##tiim\u003C/code> on irc.libera.chat\u003C/a>. My name on IRC is \u003Ccode>tiim\u003C/code>.\u003C/p>\n\u003Cblockquote class=\"callout callout-info\">\n\u003Cspan class=\"callout-title\">\u003Cspan class=\"callout-icon\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\u003Cpath d=\"M256 512c141.4 0 256-114.6 256-256S397.4 0 256 0 0 114.6 0 256s114.6 256 256 256m-40-176h24v-64h-24c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-80c-13.3 0-24-10.7-24-24s10.7-24 24-24m40-144c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32\">\u003C/path>\u003C/svg>\u003C/span>Update 2022-01-18\u003C/span>\u003Cp>I have found that at the beginning of a session, the input to weechat doesn't seem to work. Sometimes weechat refuses to let me type anything and/or doesn't recognize mouse events.\nAfter a while of spamming keys and \u003Ccode>Alt-m\u003C/code> (toggle mouse mode), it seems to fix itself most of the time.\nI have no idea if thats a problem with weechat, with docker or with ssh, and so far have not found a solution for this. If you have the same problem or even know how to fix it, feel free to reach out.\u003C/p>\n\u003C/blockquote>",slug:"blog/2023-01-15-weechat-docker",uuid:"889ff4db-3ccb-4ab1-9676-a2b0ea8f19eb",date:new Date(1673740800000),created:new Date(1673741827000),aliases:[null],title:"Running the WeeChat IRC Client on a VPS in Docker",published:true,modified:new Date(1674041667000),description:"Walkthrough on how to setup the WeeChat IRC client in docker.",cover_image:"https://media.tiim.ch/a28c65a1-ed95-43d3-af87-a2ad222bee7f.jpg",cover_image_txt:"Stable Diffusion - anime landscape, pastel colors, thick outlines, forest, mountains, golden light",content_tags:["irc","weechat","docker"],abstract:"\u003Cp>I have recently gotten interested in IRC for some reason and have been looking for a client that I like. I have used \u003Ca href=\"https://hexchat.github.io/\">HexChat\u003C/a> in the past, but I don't really fancy having yet another communications program running on my PC next to discord, zoom, telegram and thunderbird. I have been trying to use the IRC feature of thunderbird, but even though it works, it feels very much like an afterthought.\u003C/p>",tags:["docker","irc","weechat"],links:void 0,type:"article",folder:"blog"},{html:"\u003Cp>An internal web app for swim schools. Developed specifically for the \"Kids\" program of \u003Ca href=\"https://www.swiss-aquatics.ch/sport-fuer-alle/kids-learn-to-swim/ausbildungssystem/\" rel=\"nofollow noopener noreferrer\">Swiss Aquatics\u003C/a>. Live in production at the Aqualetics swim school since August 2019.\u003C/p>\n\u003Cp>The web app allows swim instructors to track students attendance, rate their progress for objectives and provide written feedback to the parents.\nThe admin page has functionality for importing and exporting students, lessons, practice objectives as well as pdf documents suited for distribution to customers. The app is currently in use by over 10 swim instructors and back office admins.\u003C/p>\n\u003Cp>\u003Cimg src=\"https://tiim.ch/assets/aqualetics-coach-screenshot.png\" alt=\"Screenshot of the coaches view\">\u003C/p>\n\u003Cp>The app is built using a Node.js, PostgreSQL, Hasura and Vue.js tech stack and runs in docker containers. The project started without Hasura and the API was manually built in node. Fortunately Hasura provides most of that functionality out of the box, so I was able to replace 90% of the backend code with it.\u003C/p>",slug:"projects/aqualetics-coach",uuid:"3210d289-1f9e-41b5-b1f9-d20f00f6a0c5",title:"Aqualetics Coach",date:new Date(1646511670000),modified:new Date(1654719348000),section:"Projects",published:true,content_tags:["node","vue","graphql","hasura","postgresql","docker","dev"],links:["\u003Cp>\u003Ca href=\"https://sundrbi.ch/coach-application/\" rel=\"nofollow noopener noreferrer\">Overview\u003C/a>\u003C/p>","\u003Cp>\u003Ca href=\"https://aqualetics.ch/2019/09/15/schwimmcoach-applikation-innovation/\" rel=\"nofollow noopener noreferrer\">Blog Post üá©üá™\u003C/a>\u003C/p>","\u003Cp>\u003Ca href=\"https://aqualetics.ch\" rel=\"nofollow noopener noreferrer\">Aqualetics Swim School\u003C/a>\u003C/p>"],abstract:"\u003Cp>An internal web app for swim schools. Developed specifically for the \"Kids\" program of \u003Ca href=\"https://www.swiss-aquatics.ch/sport-fuer-alle/kids-learn-to-swim/ausbildungssystem/\">Swiss Aquatics\u003C/a>. Live in production at the Aqualetics swim school since August 2019.\u003C/p>",tags:["dev","docker","graphql","hasura","node","postgresql","vue"],type:"article",cover_image:void 0,description:"",folder:"projects"},{html:"\u003Cp>I blogged about creating a comment system for my website \u003Ca href=\"https://tiim.ch/blog/2022-07-12-first-go-project-commenting-api\" rel=\"nofollow noopener noreferrer\">a while ago\u003C/a>,\nand later how I \u003Ca href=\"https://tiim.ch/blog/2022-12-indiewebifying-my-website-part-1\" rel=\"nofollow noopener noreferrer\">implemented webmentions into that same project\u003C/a>.\nSince then this little go program has grown quite a bit, and it has turned into a modular platform\nthat supports quite a few technologies:\u003C/p>\n\u003Cul>\n\u003Cli>The basic commenting system\u003C/li>\n\u003Cli>Sending and receiving webmentions\u003C/li>\n\u003Cli>Micropub server implementation\u003C/li>\n\u003Cli>IndieAuth (decentralized authentication standard based on OAuth)\u003C/li>\n\u003Cli>Admin dashboard\u003C/li>\n\u003Cli>Admin backup endpoint\u003C/li>\n\u003C/ul>\n\u003Cp>Currently I am working on supporting AcitvityPub, so people can follow my blog through the fediverse, and\ncomments through the fediverse show up back on my website.\u003C/p>\n\u003Cp>The architecture of the application is inspired by the Caddy webserver, where every feature is implemented as a plugin, and the core\nof the application is only concerned with initializing those plugins.\u003C/p>\n\u003Cp>If you have any questions, or want to run IndieGo yourself, don't hesitate to \u003Ca href=\"https://tiim.ch/contact\" rel=\"nofollow noopener noreferrer\">contact me\u003C/a>.\u003C/p>",slug:"projects/indiego",uuid:"0cf125b3-a99a-4996-8f84-ec5105d64c57",title:"IndieGo",date:new Date(1690965540000),modified:null,section:"Projects",published:true,cover_image:"/assets/2022-07-first-go-project-commenting-api.png",content_tags:["go","golang","indieweb","docker","sqlite","dev"],links:["\u003Cp>\u003Ca href=\"https://github.com/Tiim/IndieGo\" rel=\"nofollow noopener noreferrer\">IndieGo Github\u003C/a>\u003C/p>","\u003Cp>\u003Ca href=\"https://comments.tiim.ch\" rel=\"nofollow noopener noreferrer\">Admin Interface\u003C/a> - authentication required\u003C/p>"],abstract:"\u003Cp>I blogged about creating a comment system for my website \u003Ca href=\"https://tiim.ch/blog/2022-07-12-first-go-project-commenting-api\">a while ago\u003C/a>,\nand later how I \u003Ca href=\"https://tiim.ch/blog/2022-12-indiewebifying-my-website-part-1\">implemented webmentions into that same project\u003C/a>.\nSince then this little go program has grown quite a bit, and it has turned into a modular platform\nthat supports quite a few technologies:\u003C/p>",tags:["dev","docker","go","golang","indieweb","sqlite"],type:"article",description:"",folder:"projects"}],details:{tag:"docker"}},uses:{params:["slug"]}}],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
  </body>
</html>
